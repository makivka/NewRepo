Commit 586 on 2023-11-16 17:21:29: Refactored code