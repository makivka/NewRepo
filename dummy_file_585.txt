Commit 585 on 2023-05-26 22:27:17: Refactored code